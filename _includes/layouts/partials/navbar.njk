{% from "layouts/partials/macros.njk" import dropdown, listItem %}
{% macro menuItem(id, url, label, isDropdown, collection) %}
    {# Mobile: simple link #}
    <li class="block md:hidden rounded-sm font-sans">
        <a id="{{ id }}-item" href="{{ url }}" class="hover:transition-colors hover:bg-success-200 rounded-sm font-sans">{{ label }}</a>
    </li>

    {# Desktop: dropdown or simple link #}
    {% if isDropdown %}
        <li class="hidden md:block dropdown rounded-sm">
            <a
                href="{{ url }}"
                id="{{ id }}Dropdown-button"
                class="px-3 hover:bg-success-800 rounded-sm"
                aria-expanded="false"
                aria-haspopup="true"
                aria-controls="{{ id }}Dropdown-menu">
                {{ label }}
                <span class="ml-1">&#9660;</span>
            </a>
            <ul class="dropdown-menu hidden md:block bg-slate-50" role="menu" aria-labelledby="{{ id }}Dropdown-button">
                {% set sortedItems = collections[collection] | sort(false, false, "data.featuredOrder") %}
                {% for item in sortedItems %}
                    <li role="menuitem" class="block w-full text-jet hover:bg-medium-blue" id="{{ id }}Dropdown-menu">
                        <a href="{{ item.url | url }}" class="font-sans" role="none" tabindex="-1" data-index="{{ loop.index0 }}">
                            {{ item.data.title }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </li>
    {% else %}
        <li class="hidden md:block rounded-sm font-sans">
            <a id="{{ id }}-menu" href="{{ url }}" class="hover:transition-colors hover:bg-success-200 rounded-sm font-sans">{{ label }}</a>
        </li>
    {% endif %}
{% endmacro %}
<div class="grid grid-cols-4 md:grid-cols-12 gap-4 max-w-4xl px-2">
    <div id="tagline" class="col-span-3 md:col-span-4">
        <a href="/" class="font-sans text-jet-200 font-semibold">
            Successful technical content through community building
        </a>
    </div>
    <button id="menuToggle" class="md:hidden col-span-1 justify-self-end" aria-expanded="false" aria-controls="menubar">
        <i class="fa-solid fa-bars text-2xl"></i>
        <span class="sr-only">Toggle menu</span>
    </button>
    <div id="menubar" class="hidden md:block col-span-4 md:col-span-8 mt-2">
        <ul
            class="md:grid md:grid-flow-col md:auto-cols-auto gap-2 items-start md:items-center md:justify-end"
            aria-label="Main navigation menu"
            role="menubar">
            {{ menuItem('blog', '/static-site-transformation/', 'Blog', true, 'blog') }}
            {{ menuItem('podcast', '/podcasts/', 'Podcast', false, '') }}
            {{ menuItem('skills', '/skills/', 'Skills', true, 'skills') }}
            {{ listItem('/about/about-ed-marsh/', 'About') }}
            {{ listItem('https://linkedin.com/in/edmarsh', 'LinkedIn') }}
            {{ listItem('https://github.com/emdashdrupal/11ty-working', 'GitHub') }}
            <li class="relative hover:text-jet-200">
                <button id="searchToggle" class="inline-flex items-center" aria-expanded="false" aria-controls="search">
                    <i class="fa-solid fa-search text-2xl"></i>
                    <span class="sr-only">Toggle search</span>
                </button>
                <div id="search" class="hidden absolute right-0 top-full mt-2 w-64 bg-whitish rounded-sm shadow-lg z-50"></div>
            </li>
            {{ listItem('/contact/', 'Contact Ed') }}
        </ul>
    </div>
</div>